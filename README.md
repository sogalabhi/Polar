# ğŸŒ‰ Polar Bridge

A cross-chain liquidity bridge enabling users to convert INR to PAS tokens (Paseo Asset Hub) via Razorpay.

## ğŸ“‹ Overview

Polar Bridge is a **custodial exchange/bridge** that allows users to:
1. **Add INR funds** via Razorpay (UPI, Card, NetBanking)
2. **Buy PAS tokens** with their INR balance
3. **Receive PAS** directly in their MetaMask wallet

---

## ğŸ—ï¸ Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    POLAR BRIDGE - CUSTODIAL MODEL                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

PLATFORM OWNER (You) owns:
â”œâ”€â”€ Stellar Wallet (XLM) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”œâ”€â”€ Paseo Wallet (PAS) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”€â”€â–º Platform Liquidity
â””â”€â”€ INR Account (Razorpay) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

USER only has:
â””â”€â”€ Their EVM Wallet (MetaMask) â”€â”€â–º Where they receive PAS tokens
```

---

## ğŸ“Š User Flow

### Part 1: Add INR Funds via Razorpay

```
USER                           PLATFORM                         DATABASE
  â”‚                               â”‚                                â”‚
  â”‚  1. Pay â‚¹500 via Razorpay     â”‚                                â”‚
  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                                â”‚
  â”‚                               â”‚                                â”‚
  â”‚                               â”‚  2. Webhook: Payment confirmed â”‚
  â”‚                               â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
  â”‚                               â”‚                                â”‚
  â”‚                               â”‚  3. Credit â‚¹500 to wallet      â”‚
  â”‚                               â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚                               â”‚                                â”‚
  â”‚  4. Balance: â‚¹500 âœ…          â”‚                                â”‚
  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

### Part 2: Buy PAS Tokens

```
USER                           PLATFORM                         BLOCKCHAIN
  â”‚                               â”‚                                â”‚
  â”‚  1. Buy 10 PAS (â‚¹500)         â”‚                                â”‚
  â”‚     To: 0xABC... (MetaMask)   â”‚                                â”‚
  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                                â”‚
  â”‚                               â”‚                                â”‚
  â”‚                               â”‚  2. Deduct â‚¹500 from wallet    â”‚
  â”‚                               â”‚                                â”‚
  â”‚                               â”‚  3. Send 10 PAS from pool      â”‚
  â”‚                               â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚                               â”‚                                â”‚
  â”‚  4. 10 PAS received! âœ…       â”‚                                â”‚
  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

---

## ğŸ“‹ Complete Flow Diagrams

<details>
<summary><b>ğŸ”¹ PART 1: USER REGISTRATION & WALLET SETUP</b></summary>

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   USER   â”‚         â”‚   FRONTEND   â”‚         â”‚   BACKEND    â”‚         â”‚   SUPABASE   â”‚
â”‚          â”‚         â”‚   (React)    â”‚         â”‚   (Express)  â”‚         â”‚   (Database) â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                      â”‚                        â”‚                        â”‚
     â”‚  1. Sign up/Login    â”‚                        â”‚                        â”‚
     â”‚      (email)         â”‚                        â”‚                        â”‚
     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                        â”‚                        â”‚
     â”‚                      â”‚                        â”‚                        â”‚
     â”‚                      â”‚  2. Create user        â”‚                        â”‚
     â”‚                      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>                        â”‚
     â”‚                      â”‚                        â”‚                        â”‚
     â”‚                      â”‚                        â”‚  3. INSERT users       â”‚
     â”‚                      â”‚                        â”‚     (email, id)        â”‚
     â”‚                      â”‚                        â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚                      â”‚                        â”‚                        â”‚
     â”‚                      â”‚                        â”‚  4. INSERT wallets     â”‚
     â”‚                      â”‚                        â”‚     (user_id,          â”‚
     â”‚                      â”‚                        â”‚      balance_inr: 0)   â”‚
     â”‚                      â”‚                        â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚                      â”‚                        â”‚                        â”‚
     â”‚  5. Connect MetaMask â”‚                        â”‚                        â”‚
     â”‚     (0xABC...)       â”‚                        â”‚                        â”‚
     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                        â”‚                        â”‚
     â”‚                      â”‚                        â”‚                        â”‚
     â”‚                      â”‚  6. Save EVM address   â”‚                        â”‚
     â”‚                      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>                        â”‚
     â”‚                      â”‚                        â”‚                        â”‚
     â”‚                      â”‚                        â”‚  7. UPDATE users       â”‚
     â”‚                      â”‚                        â”‚     SET evm_address    â”‚
     â”‚                      â”‚                        â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚                      â”‚                        â”‚                        â”‚
     â–¼                      â–¼                        â–¼                        â–¼
```

</details>

<details>
<summary><b>ğŸ”¹ PART 2: ADD INR FUNDS VIA RAZORPAY</b></summary>

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   USER   â”‚    â”‚   FRONTEND   â”‚    â”‚   BACKEND    â”‚    â”‚   RAZORPAY   â”‚    â”‚   SUPABASE   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                 â”‚                   â”‚                   â”‚                   â”‚
     â”‚  1. Click       â”‚                   â”‚                   â”‚                   â”‚
     â”‚  "Add â‚¹500"     â”‚                   â”‚                   â”‚                   â”‚
     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                   â”‚                   â”‚                   â”‚
     â”‚                 â”‚                   â”‚                   â”‚                   â”‚
     â”‚                 â”‚  2. POST /api/    â”‚                   â”‚                   â”‚
     â”‚                 â”‚     create-order  â”‚                   â”‚                   â”‚
     â”‚                 â”‚     {amount: 500} â”‚                   â”‚                   â”‚
     â”‚                 â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                   â”‚                   â”‚
     â”‚                 â”‚                   â”‚                   â”‚                   â”‚
     â”‚                 â”‚                   â”‚  3. Create order  â”‚                   â”‚
     â”‚                 â”‚                   â”‚     razorpay.     â”‚                   â”‚
     â”‚                 â”‚                   â”‚     orders.create â”‚                   â”‚
     â”‚                 â”‚                   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                   â”‚
     â”‚                 â”‚                   â”‚                   â”‚                   â”‚
     â”‚                 â”‚                   â”‚  4. order_id      â”‚                   â”‚
     â”‚                 â”‚                   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                   â”‚
     â”‚                 â”‚                   â”‚                   â”‚                   â”‚
     â”‚                 â”‚                   â”‚  5. INSERT        â”‚                   â”‚
     â”‚                 â”‚                   â”‚     inr_deposits  â”‚                   â”‚
     â”‚                 â”‚                   â”‚     (pending)     â”‚                   â”‚
     â”‚                 â”‚                   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚                 â”‚                   â”‚                   â”‚                   â”‚
     â”‚                 â”‚  6. Return        â”‚                   â”‚                   â”‚
     â”‚                 â”‚     order_id      â”‚                   â”‚                   â”‚
     â”‚                 â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                   â”‚                   â”‚
     â”‚                 â”‚                   â”‚                   â”‚                   â”‚
     â”‚  7. Open        â”‚                   â”‚                   â”‚                   â”‚
     â”‚     Razorpay    â”‚                   â”‚                   â”‚                   â”‚
     â”‚     Checkout    â”‚                   â”‚                   â”‚                   â”‚
     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                   â”‚                   â”‚                   â”‚
     â”‚                 â”‚                   â”‚                   â”‚                   â”‚
     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚                   â”‚
     â”‚  â”‚         RAZORPAY CHECKOUT MODAL                 â”‚    â”‚                   â”‚
     â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚                   â”‚
     â”‚  â”‚  â”‚  Amount: â‚¹500                             â”‚  â”‚    â”‚                   â”‚
     â”‚  â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚  â”‚    â”‚                   â”‚
     â”‚  â”‚  â”‚  [UPI]  [Card]  [NetBanking]  [Wallet]    â”‚  â”‚    â”‚                   â”‚
     â”‚  â”‚  â”‚                                           â”‚  â”‚    â”‚                   â”‚
     â”‚  â”‚  â”‚  UPI ID: user@paytm                       â”‚  â”‚    â”‚                   â”‚
     â”‚  â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚  â”‚    â”‚                   â”‚
     â”‚  â”‚  â”‚           [ PAY â‚¹500 ]                    â”‚  â”‚    â”‚                   â”‚
     â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚                   â”‚
     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚                   â”‚
     â”‚                 â”‚                   â”‚                   â”‚                   â”‚
     â”‚  8. Complete    â”‚                   â”‚                   â”‚                   â”‚
     â”‚     payment     â”‚                   â”‚                   â”‚                   â”‚
     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>                   â”‚
     â”‚                 â”‚                   â”‚                   â”‚                   â”‚
     â”‚                 â”‚                   â”‚  9. WEBHOOK POST  â”‚                   â”‚
     â”‚                 â”‚                   â”‚     /webhook/     â”‚                   â”‚
     â”‚                 â”‚                   â”‚     razorpay      â”‚                   â”‚
     â”‚                 â”‚                   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                   â”‚
     â”‚                 â”‚                   â”‚                   â”‚                   â”‚
     â”‚                 â”‚                   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
     â”‚                 â”‚                   â”‚  â”‚  WEBHOOK PAYLOAD                â”‚  â”‚
     â”‚                 â”‚                   â”‚  â”‚  {                              â”‚  â”‚
     â”‚                 â”‚                   â”‚  â”‚    event: "payment.captured",   â”‚  â”‚
     â”‚                 â”‚                   â”‚  â”‚    payload: {                   â”‚  â”‚
     â”‚                 â”‚                   â”‚  â”‚      payment: {                 â”‚  â”‚
     â”‚                 â”‚                   â”‚  â”‚        id: "pay_ABC123",        â”‚  â”‚
     â”‚                 â”‚                   â”‚  â”‚        order_id: "order_XYZ",   â”‚  â”‚
     â”‚                 â”‚                   â”‚  â”‚        amount: 50000, // paise  â”‚  â”‚
     â”‚                 â”‚                   â”‚  â”‚        status: "captured"       â”‚  â”‚
     â”‚                 â”‚                   â”‚  â”‚      }                          â”‚  â”‚
     â”‚                 â”‚                   â”‚  â”‚    }                            â”‚  â”‚
     â”‚                 â”‚                   â”‚  â”‚  }                              â”‚  â”‚
     â”‚                 â”‚                   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
     â”‚                 â”‚                   â”‚                   â”‚                   â”‚
     â”‚                 â”‚                   â”‚  10. Verify       â”‚                   â”‚
     â”‚                 â”‚                   â”‚      signature    â”‚                   â”‚
     â”‚                 â”‚                   â”‚      (HMAC SHA256)â”‚                   â”‚
     â”‚                 â”‚                   â”‚                   â”‚                   â”‚
     â”‚                 â”‚                   â”‚  11. UPDATE       â”‚                   â”‚
     â”‚                 â”‚                   â”‚      inr_deposits â”‚                   â”‚
     â”‚                 â”‚                   â”‚      SET status = â”‚                   â”‚
     â”‚                 â”‚                   â”‚      'completed'  â”‚                   â”‚
     â”‚                 â”‚                   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚                 â”‚                   â”‚                   â”‚                   â”‚
     â”‚                 â”‚                   â”‚  12. UPDATE       â”‚                   â”‚
     â”‚                 â”‚                   â”‚      wallets      â”‚                   â”‚
     â”‚                 â”‚                   â”‚      SET balance  â”‚                   â”‚
     â”‚                 â”‚                   â”‚      += â‚¹500      â”‚                   â”‚
     â”‚                 â”‚                   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚                 â”‚                   â”‚                   â”‚                   â”‚
     â”‚  13. Payment    â”‚                   â”‚                   â”‚                   â”‚
     â”‚      Success!   â”‚                   â”‚                   â”‚                   â”‚
     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                   â”‚                   â”‚                   â”‚
     â”‚                 â”‚                   â”‚                   â”‚                   â”‚
     â”‚  14. Refresh    â”‚                   â”‚                   â”‚                   â”‚
     â”‚      balance    â”‚                   â”‚                   â”‚                   â”‚
     â”‚      â†’ â‚¹500     â”‚                   â”‚                   â”‚                   â”‚
     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                   â”‚                   â”‚                   â”‚
     â”‚                 â”‚                   â”‚                   â”‚                   â”‚
     â–¼                 â–¼                   â–¼                   â–¼                   â–¼
```

</details>

<details>
<summary><b>ğŸ”¹ PART 3: BUY PAS TOKENS WITH INR BALANCE</b></summary>

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   USER   â”‚    â”‚   FRONTEND   â”‚    â”‚   BACKEND    â”‚    â”‚   SUPABASE   â”‚    â”‚  BLOCKCHAIN  â”‚
â”‚          â”‚    â”‚   (React)    â”‚    â”‚   (Express)  â”‚    â”‚   (Database) â”‚    â”‚  (Paseo Hub) â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                 â”‚                   â”‚                   â”‚                   â”‚
     â”‚  1. User sees:  â”‚                   â”‚                   â”‚                   â”‚
     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                   â”‚                   â”‚
     â”‚  â”‚  Wallet Balance: â‚¹500          â”‚ â”‚                   â”‚                   â”‚
     â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚                   â”‚                   â”‚
     â”‚  â”‚  Buy Crypto:                   â”‚ â”‚                   â”‚                   â”‚
     â”‚  â”‚  [PAS â–¼] Amount: [____] PAS    â”‚ â”‚                   â”‚                   â”‚
     â”‚  â”‚                                â”‚ â”‚                   â”‚                   â”‚
     â”‚  â”‚  Rate: 1 PAS = â‚¹50             â”‚ â”‚                   â”‚                   â”‚
     â”‚  â”‚  You get: 10 PAS               â”‚ â”‚                   â”‚                   â”‚
     â”‚  â”‚  Cost: â‚¹500                    â”‚ â”‚                   â”‚                   â”‚
     â”‚  â”‚                                â”‚ â”‚                   â”‚                   â”‚
     â”‚  â”‚  Your wallet: 0xABC...123      â”‚ â”‚                   â”‚                   â”‚
     â”‚  â”‚                                â”‚ â”‚                   â”‚                   â”‚
     â”‚  â”‚  [ BUY 10 PAS for â‚¹500 ]       â”‚ â”‚                   â”‚                   â”‚
     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                   â”‚                   â”‚
     â”‚                 â”‚                   â”‚                   â”‚                   â”‚
     â”‚  2. Click       â”‚                   â”‚                   â”‚                   â”‚
     â”‚  "BUY 10 PAS"   â”‚                   â”‚                   â”‚                   â”‚
     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                   â”‚                   â”‚                   â”‚
     â”‚                 â”‚                   â”‚                   â”‚                   â”‚
     â”‚                 â”‚  3. POST /api/    â”‚                   â”‚                   â”‚
     â”‚                 â”‚     buy-crypto    â”‚                   â”‚                   â”‚
     â”‚                 â”‚     {             â”‚                   â”‚                   â”‚
     â”‚                 â”‚       token: PAS, â”‚                   â”‚                   â”‚
     â”‚                 â”‚       amount: 10, â”‚                   â”‚                   â”‚
     â”‚                 â”‚       evm: 0xABC  â”‚                   â”‚                   â”‚
     â”‚                 â”‚     }             â”‚                   â”‚                   â”‚
     â”‚                 â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                   â”‚                   â”‚
     â”‚                 â”‚                   â”‚                   â”‚                   â”‚
     â”‚                 â”‚                   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
     â”‚                 â”‚                   â”‚  â”‚  BACKEND PROCESSING             â”‚  â”‚
     â”‚                 â”‚                   â”‚  â”‚                                 â”‚  â”‚
     â”‚                 â”‚                   â”‚  â”‚  4. Get exchange rate           â”‚  â”‚
     â”‚                 â”‚                   â”‚  â”‚     1 PAS = â‚¹50                 â”‚  â”‚
     â”‚                 â”‚                   â”‚  â”‚                                 â”‚  â”‚
     â”‚                 â”‚                   â”‚  â”‚  5. Calculate cost              â”‚  â”‚
     â”‚                 â”‚                   â”‚  â”‚     10 PAS Ã— â‚¹50 = â‚¹500         â”‚  â”‚
     â”‚                 â”‚                   â”‚  â”‚                                 â”‚  â”‚
     â”‚                 â”‚                   â”‚  â”‚  6. Check user balance â‰¥ â‚¹500   â”‚  â”‚
     â”‚                 â”‚                   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
     â”‚                 â”‚                   â”‚                   â”‚                   â”‚
     â”‚                 â”‚                   â”‚  7. SELECT        â”‚                   â”‚
     â”‚                 â”‚                   â”‚     balance_inr   â”‚                   â”‚
     â”‚                 â”‚                   â”‚     FROM wallets  â”‚                   â”‚
     â”‚                 â”‚                   â”‚     WHERE user_id â”‚                   â”‚
     â”‚                 â”‚                   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                   â”‚
     â”‚                 â”‚                   â”‚                   â”‚                   â”‚
     â”‚                 â”‚                   â”‚  8. balance: 500  â”‚                   â”‚
     â”‚                 â”‚                   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                   â”‚
     â”‚                 â”‚                   â”‚                   â”‚                   â”‚
     â”‚                 â”‚                   â”‚  9. BEGIN         â”‚                   â”‚
     â”‚                 â”‚                   â”‚     TRANSACTION   â”‚                   â”‚
     â”‚                 â”‚                   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                   â”‚
     â”‚                 â”‚                   â”‚                   â”‚                   â”‚
     â”‚                 â”‚                   â”‚  10. UPDATE       â”‚                   â”‚
     â”‚                 â”‚                   â”‚      wallets      â”‚                   â”‚
     â”‚                 â”‚                   â”‚      SET balance  â”‚                   â”‚
     â”‚                 â”‚                   â”‚      -= â‚¹500      â”‚                   â”‚
     â”‚                 â”‚                   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                   â”‚
     â”‚                 â”‚                   â”‚                   â”‚                   â”‚
     â”‚                 â”‚                   â”‚  11. INSERT       â”‚                   â”‚
     â”‚                 â”‚                   â”‚      crypto_      â”‚                   â”‚
     â”‚                 â”‚                   â”‚      purchases    â”‚                   â”‚
     â”‚                 â”‚                   â”‚      (pending)    â”‚                   â”‚
     â”‚                 â”‚                   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                   â”‚
     â”‚                 â”‚                   â”‚                   â”‚                   â”‚
     â”‚                 â”‚                   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                 â”‚                   â”‚  â”‚  12. SEND PAS TOKENS ON BLOCKCHAIN      â”‚
     â”‚                 â”‚                   â”‚  â”‚                                         â”‚
     â”‚                 â”‚                   â”‚  â”‚  YOUR EVM POOL                          â”‚
     â”‚                 â”‚                   â”‚  â”‚  (0x1Df2Cc...37cE6)                     â”‚
     â”‚                 â”‚                   â”‚  â”‚  Balance: 1.0 PAS                       â”‚
     â”‚                 â”‚                   â”‚  â”‚       â”‚                                 â”‚
     â”‚                 â”‚                   â”‚  â”‚       â”‚ releaseLiquidity(               â”‚
     â”‚                 â”‚                   â”‚  â”‚       â”‚   to: 0xABC...123,              â”‚
     â”‚                 â”‚                   â”‚  â”‚       â”‚   amount: 10 PAS                â”‚
     â”‚                 â”‚                   â”‚  â”‚       â”‚ )                               â”‚
     â”‚                 â”‚                   â”‚  â”‚       â–¼                                 â”‚
     â”‚                 â”‚                   â”‚  â”‚  USER'S METAMASK                        â”‚
     â”‚                 â”‚                   â”‚  â”‚  (0xABC...123)                          â”‚
     â”‚                 â”‚                   â”‚  â”‚  Balance: 0 â†’ 10 PAS                    â”‚
     â”‚                 â”‚                   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                 â”‚                   â”‚                   â”‚                   â”‚
     â”‚                 â”‚                   â”‚  13. Call         â”‚                   â”‚
     â”‚                 â”‚                   â”‚      poolContract.â”‚                   â”‚
     â”‚                 â”‚                   â”‚      releaseLiquidity()               â”‚
     â”‚                 â”‚                   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚
     â”‚                 â”‚                   â”‚                   â”‚                   â”‚
     â”‚                 â”‚                   â”‚  14. TX Hash      â”‚                   â”‚
     â”‚                 â”‚                   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
     â”‚                 â”‚                   â”‚                   â”‚                   â”‚
     â”‚                 â”‚                   â”‚  15. Wait for     â”‚                   â”‚
     â”‚                 â”‚                   â”‚      confirmation â”‚                   â”‚
     â”‚                 â”‚                   â”‚      (1-2 blocks) â”‚                   â”‚
     â”‚                 â”‚                   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
     â”‚                 â”‚                   â”‚                   â”‚                   â”‚
     â”‚                 â”‚                   â”‚  16. UPDATE       â”‚                   â”‚
     â”‚                 â”‚                   â”‚      crypto_      â”‚                   â”‚
     â”‚                 â”‚                   â”‚      purchases    â”‚                   â”‚
     â”‚                 â”‚                   â”‚      SET status = â”‚                   â”‚
     â”‚                 â”‚                   â”‚      'completed', â”‚                   â”‚
     â”‚                 â”‚                   â”‚      tx_hash = .. â”‚                   â”‚
     â”‚                 â”‚                   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                   â”‚
     â”‚                 â”‚                   â”‚                   â”‚                   â”‚
     â”‚                 â”‚                   â”‚  17. COMMIT       â”‚                   â”‚
     â”‚                 â”‚                   â”‚      TRANSACTION  â”‚                   â”‚
     â”‚                 â”‚                   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                   â”‚
     â”‚                 â”‚                   â”‚                   â”‚                   â”‚
     â”‚                 â”‚  18. Success!     â”‚                   â”‚                   â”‚
     â”‚                 â”‚      tx_hash      â”‚                   â”‚                   â”‚
     â”‚                 â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                   â”‚                   â”‚
     â”‚                 â”‚                   â”‚                   â”‚                   â”‚
     â”‚  19. Show       â”‚                   â”‚                   â”‚                   â”‚
     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                   â”‚                   â”‚
     â”‚  â”‚  âœ… Success!                   â”‚ â”‚                   â”‚                   â”‚
     â”‚  â”‚                                â”‚ â”‚                   â”‚                   â”‚
     â”‚  â”‚  10 PAS sent to your wallet!   â”‚ â”‚                   â”‚                   â”‚
     â”‚  â”‚                                â”‚ â”‚                   â”‚                   â”‚
     â”‚  â”‚  TX: 0x7f8a...3c2b             â”‚ â”‚                   â”‚                   â”‚
     â”‚  â”‚  [View on Explorer]            â”‚ â”‚                   â”‚                   â”‚
     â”‚  â”‚                                â”‚ â”‚                   â”‚                   â”‚
     â”‚  â”‚  Wallet Balance: â‚¹0            â”‚ â”‚                   â”‚                   â”‚
     â”‚  â”‚  PAS Balance: 10 PAS           â”‚ â”‚                   â”‚                   â”‚
     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                   â”‚                   â”‚
     â”‚                 â”‚                   â”‚                   â”‚                   â”‚
     â–¼                 â–¼                   â–¼                   â–¼                   â–¼
```

</details>

<details>
<summary><b>ğŸ”¹ DATABASE STATE AFTER FLOW</b></summary>

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TABLE: users                                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ id          â”‚ email               â”‚ evm_address                                  â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ uuid-123    â”‚ user@example.com    â”‚ 0xABC...123                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TABLE: wallets                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚
â”‚  â”‚ user_id     â”‚ balance_inr         â”‚ updated_at   â”‚                                   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                   â”‚
â”‚  â”‚ uuid-123    â”‚ 0.00                â”‚ 2025-12-05   â”‚  â† Was â‚¹500, now â‚¹0 after buy     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TABLE: inr_deposits                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ user_id   â”‚ razorpay_id    â”‚ amount_inr â”‚ status    â”‚ created_at                â”‚    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚  â”‚ uuid-123  â”‚ pay_ABC123     â”‚ 500.00     â”‚ completed â”‚ 2025-12-05 10:00:00       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TABLE: crypto_purchases                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ user_id   â”‚ from_inr â”‚ to_token  â”‚ to_amt   â”‚ rate      â”‚ status      â”‚ tx_hash   â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ uuid-123  â”‚ 500.00   â”‚ PAS       â”‚ 10.00    â”‚ 50.00     â”‚ completed   â”‚ 0x7f8...  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

</details>

<details>
<summary><b>ğŸ”¹ INTERNAL ACCOUNTING (Platform Side)</b></summary>

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                                         â”‚
â”‚  YOUR RAZORPAY ACCOUNT                    YOUR EVM POOL CONTRACT                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚                         â”‚              â”‚                         â”‚                   â”‚
â”‚  â”‚  Received: â‚¹500         â”‚              â”‚  Before: 1.0 PAS        â”‚                   â”‚
â”‚  â”‚  (minus Razorpay fees)  â”‚              â”‚  Sent: -10 PAS          â”‚                   â”‚
â”‚  â”‚                         â”‚              â”‚  After: -9.0 PAS        â”‚                   â”‚
â”‚  â”‚  Net: ~â‚¹490             â”‚              â”‚  (needs refill!)        â”‚                   â”‚
â”‚  â”‚                         â”‚              â”‚                         â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                                                         â”‚
â”‚  âš ï¸ IMPORTANT: You need to keep your EVM pool funded!                                  â”‚
â”‚     If pool runs out of PAS, purchases will fail.                                       â”‚
â”‚                                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

</details>

---

## ğŸ”§ Tech Stack

| Component | Technology |
|-----------|------------|
| **Frontend** | React + Vite |
| **Backend** | Node.js + Express |
| **Database** | Supabase (PostgreSQL) |
| **Payment** | Razorpay |
| **Blockchain** | Paseo Asset Hub (EVM) |
| **Smart Contract** | Solidity (EVM Pool) |
| **Wallet** | MetaMask |

---

## ğŸ“ Project Structure

```
polar/
â”œâ”€â”€ contracts/
â”‚   â”œâ”€â”€ evm-pool/                 # Solidity EVM Pool Contract
â”‚   â”‚   â””â”€â”€ PolkaBridgePool.sol
â”‚   â”œâ”€â”€ soroban-vault/            # Stellar Soroban Contract (internal)
â”‚   â”‚   â””â”€â”€ src/lib.rs
â”‚   â””â”€â”€ ink-pool/                 # ink! Contract (optional)
â”‚
â”œâ”€â”€ relayer/                      # Backend Server
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ index.js              # Bridge relayer
â”‚   â”‚   â”œâ”€â”€ server.js             # Express API (TODO)
â”‚   â”‚   â””â”€â”€ razorpay.js           # Razorpay webhooks (TODO)
â”‚   â”œâ”€â”€ .env
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ frontend/                     # React App (TODO)
â”‚   â””â”€â”€ src/
â”‚
â””â”€â”€ README.md
```

---

## ğŸš€ Deployed Contracts

### Paseo Asset Hub (EVM)

| Item | Value |
|------|-------|
| **Pool Contract** | `0x49e12e876588052A977dB816107B1772B4103E3e` |
| **Admin** | `0xe8cb3F3BA7C674B6fb3C5B3cBe572964a5569D53` |
| **Network** | Paseo Asset Hub (Chain ID: 420420422) |
| **Explorer** | [Blockscout](https://blockscout-passet-hub.parity-testnet.parity.io/address/0x49e12e876588052A977dB816107B1772B4103E3e) |

### Stellar Testnet (Internal)

| Item | Value |
|------|-------|
| **Vault Contract** | `CDI75PQ4EA2VBTT7W6EZN2RGJIS4CFDMGT7WJ4L42T4ZSTNEKY42NY2B` |
| **Admin** | `GBXLFRL35YDKSDMJJ2TT7VW25I7C7B76RKFYCB6FMIXWEAMAX3GESCN3` |

---

## âš™ï¸ Setup

### Prerequisites

- Node.js 18+
- npm or yarn
- MetaMask wallet
- Razorpay account (for payments)
- Supabase account (for database)

### Installation

```bash
# Clone the repo
git clone https://github.com/sogalabhi/polar.git
cd polar

# Install relayer dependencies
cd relayer
npm install

# Copy environment file
cp .env.example .env
# Edit .env with your credentials
```

### Environment Variables

```bash
# relayer/.env

# Paseo Asset Hub EVM Configuration
PASEO_RPC_URL=https://testnet-passet-hub-eth-rpc.polkadot.io
EVM_POOL_ADDRESS=0x49e12e876588052A977dB816107B1772B4103E3e
EVM_RELAYER_PRIVATE_KEY=your_private_key_here

# Supabase
SUPABASE_URL=your_supabase_url
SUPABASE_ANON_KEY=your_anon_key

# Razorpay
RAZORPAY_KEY_ID=your_key_id
RAZORPAY_KEY_SECRET=your_key_secret
RAZORPAY_WEBHOOK_SECRET=your_webhook_secret
```

### Run the Relayer

```bash
cd relayer
node src/index.js
```

---

## ğŸ“Š Database Schema (Supabase)

```sql
-- Users
CREATE TABLE users (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    email TEXT UNIQUE NOT NULL,
    evm_address TEXT,
    created_at TIMESTAMPTZ DEFAULT NOW()
);

-- Wallets (INR balance)
CREATE TABLE wallets (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(id) UNIQUE,
    balance_inr DECIMAL(15, 2) DEFAULT 0,
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- INR Deposits (Razorpay)
CREATE TABLE inr_deposits (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(id),
    razorpay_payment_id TEXT UNIQUE,
    amount_inr DECIMAL(15, 2),
    status TEXT DEFAULT 'pending',
    created_at TIMESTAMPTZ DEFAULT NOW()
);

-- Crypto Purchases
CREATE TABLE crypto_purchases (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(id),
    from_amount DECIMAL(15, 2),
    to_token TEXT,
    to_amount DECIMAL(18, 8),
    exchange_rate DECIMAL(15, 6),
    destination_address TEXT,
    tx_hash TEXT,
    status TEXT DEFAULT 'pending',
    created_at TIMESTAMPTZ DEFAULT NOW()
);
```

---

## ğŸ”„ API Endpoints

| Method | Endpoint | Description |
|--------|----------|-------------|
| POST | `/api/auth/signup` | Create user account |
| POST | `/api/auth/login` | Login user |
| POST | `/api/wallet/address` | Save EVM address |
| GET | `/api/wallet/balance` | Get INR balance |
| POST | `/api/razorpay/create-order` | Create Razorpay order |
| POST | `/webhook/razorpay` | Handle payment webhook |
| GET | `/api/rates` | Get exchange rates |
| POST | `/api/crypto/buy` | Buy crypto with INR |
| GET | `/api/transactions` | Transaction history |

---

## ğŸ›£ï¸ Roadmap

- [x] EVM Pool Contract (Paseo Asset Hub)
- [x] Stellar Vault Contract (internal)
- [x] Bridge Relayer
- [ ] Supabase Integration
- [ ] Razorpay Integration
- [ ] Frontend UI
- [ ] Production Deployment

---

## ğŸ“„ License

MIT

---

## ğŸ¤ Contributing

Pull requests are welcome!
